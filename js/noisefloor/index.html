<head>
    <script type="text/javascript" src="noisefloor.js"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/javascript">
        noisefloorjs.renderFrontEnd();

        var frameLength  = 8192
        var sampleBuffer = [
            new Float32Array(Array(frameLength).fill(0)),
            new Float32Array(Array(frameLength).fill(0))
            ];

        var audioContext = new AudioContext();

        noisefloorjs.start(audioContext.sampleRate);

        var node = audioContext.createScriptProcessor(frameLength, 2, 2);
        node.onaudioprocess = function (event) {
            var output = event.outputBuffer.getChannelData(0);
            var midiIn = noisefloorjs.getMIDIEvents();

            noisefloorjs.process(sampleBuffer, sampleBuffer, midiIn, midiIn);
            event.outputBuffer.copyToChannel(sampleBuffer[0], 0);
            event.outputBuffer.copyToChannel(sampleBuffer[1], 1);
        }
        node.connect(audioContext.destination);

        console.log('Running process');
    </script>
</body>
