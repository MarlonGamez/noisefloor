<head>
    <script type="text/javascript" src="noisefloorjs.js"></script>
</head>
<body>
    <script type="text/javascript">
        var midiEvent = noisefloorjs.makeMidiEvent(20, [60, 127, 0]);

        var frameLength  = 512
        var sampleBuffer = [
            new Float32Array(Array(frameLength).fill(0)),
            new Float32Array(Array(frameLength).fill(0))
            ];
        var audioContext = new AudioContext();

        noisefloorjs.start(audioContext.sampleRate);
        var midiIn = [{time:100, data:[1,2,3]}];

        var node = audioContext.createScriptProcessor(frameLength, 2, 2);
        node.onaudioprocess = function (event) {
            var output     = event.outputBuffer.getChannelData(0);
            // var midiEvents = frontend.getMIDIEvents();

            noisefloorjs.process(sampleBuffer, sampleBuffer, midiIn, midiIn);
            event.outputBuffer.copyToChannel(sampleBuffer[0], 0);
            event.outputBuffer.copyToChannel(sampleBuffer[1], 1);
        }
        node.connect(audioContext.destination);

        // console.log('Running process');
        // var main = global.main;

        // noisefloorjs.start(100);
        // noisefloorjs.process();
    </script>
</body>
