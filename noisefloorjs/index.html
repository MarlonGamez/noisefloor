<head>
    <script type="text/javascript" src="noisefloorjs.js"></script>
</head>
<body>
    <script type="text/javascript">
        var frameLength  = 512
        var sampleBuffer = new Float32Array(Array(frameLength).fill(0));
        var audioContext = new AudioContext();

        noisefloorjs.start(audioContext.sampleRate)

        var node = audioContext.createScriptProcessor(frameLength, 2, 2);
        node.onaudioprocess = function (event) {
            var output     = event.outputBuffer.getChannelData(0);
            // var midiEvents = frontend.getMIDIEvents();

            noisefloorjs.process(sampleBuffer, sampleBuffer);
            event.outputBuffer.copyToChannel(sampleBuffer, 0);
            event.outputBuffer.copyToChannel(sampleBuffer, 1);
        }
        node.connect(audioContext.destination);

        // console.log('Running process');
        // var main = global.main;

        // noisefloorjs.start(100);
        // noisefloorjs.process();
    </script>
</body>
